<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cuventor | coming soon</title>
    <!-- EmailJS SDK - Updated CDN -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <!-- Font preload for better performance -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Gentium+Plus:ital@0;1&family=Montserrat:wght@400;700;900&display=swap" as="style">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Gentium+Plus:ital@0;1&family=Montserrat:wght@400;700;900&display=swap">
    <style>
        /* Previous styles remain the same */
        @font-display: swap; /* Add this for better font loading */
        
        .newsletter-form {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--white);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 320px;
            opacity: 0;
            animation: fadeIn 1s ease forwards;
            animation-delay: 1.5s;
            z-index: 1000;
            transition: transform 0.3s ease-in-out;
        }

        /* Rest of your styles remain the same */
    </style>
</head>
<body>
    <!-- Previous HTML content remains the same until newsletter form -->

    <form id="newsletter-form" class="newsletter-form">
        <button type="button" class="close-btn" aria-label="Close newsletter">&times;</button>
        <h3>Subscribe for 15% off</h3>
        <input type="email" id="subscriber-email" placeholder="Enter your email" required>
        <button type="submit" id="submit-btn">Subscribe</button>
        <div id="success-message" class="message success-message">Thanks for subscribing! Check your email for the discount code.</div>
        <div id="error-message" class="message error-message">Oops! Something went wrong. Please try again.</div>
    </form>

    <script type="text/javascript">
        // Initialize EmailJS
        (function() {
            // Make sure the script is loaded before initializing
            if (typeof emailjs !== 'undefined') {
                emailjs.init("paJmeJVY3SOibQbfj");
            } else {
                console.error('EmailJS not loaded properly');
            }
        })();

        // Newsletter functionality
        document.addEventListener('DOMContentLoaded', () => {
            const newsletterForm = document.getElementById('newsletter-form');
            const closeBtn = document.querySelector('.close-btn');
            const submitBtn = document.getElementById('submit-btn');
            const successMessage = document.getElementById('success-message');
            const errorMessage = document.getElementById('error-message');
            const emailInput = document.getElementById('subscriber-email');

            // Check if user has already subscribed
            const hasSubscribed = localStorage.getItem('newsletter_subscribed');
            const lastClosed = localStorage.getItem('newsletter_closed');
            const currentTime = new Date().getTime();

            // Show newsletter form based on conditions
            if (hasSubscribed === 'true') {
                newsletterForm.style.display = 'none';
            } else if (lastClosed) {
                // Show again after 24 hours
                if (currentTime - parseInt(lastClosed) > 24 * 60 * 60 * 1000) {
                    newsletterForm.style.display = 'block';
                    localStorage.removeItem('newsletter_closed');
                } else {
                    newsletterForm.style.display = 'none';
                }
            }

            // Close button functionality
            closeBtn.addEventListener('click', () => {
                newsletterForm.classList.add('slide-out');
                localStorage.setItem('newsletter_closed', currentTime.toString());
                setTimeout(() => {
                    newsletterForm.style.display = 'none';
                    newsletterForm.classList.remove('slide-out');
                }, 300);
            });

            // Form submission
            newsletterForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                submitBtn.disabled = true;
                submitBtn.textContent = 'Subscribing...';

                try {
                    await emailjs.send(
                        "service_yizvedh", // Your EmailJS service ID
                        "template_x4kiw7f", // Your EmailJS template ID
                        {
                            subscriber_email: emailInput.value,
                            discount_code: "CUVENTOR15"
                        },
                        "paJmeJVY3SOibQbfj" // Your EmailJS public key
                    );

                    localStorage.setItem('newsletter_subscribed', 'true');
                    successMessage.style.display = 'block';
                    errorMessage.style.display = 'none';
                    emailInput.value = '';
                    
                    // Hide form after success
                    setTimeout(() => {
                        newsletterForm.classList.add('slide-out');
                        setTimeout(() => {
                            newsletterForm.style.display = 'none';
                            newsletterForm.classList.remove('slide-out');
                        }, 300);
                    }, 3000);
                } catch (error) {
                    console.error('EmailJS error:', error);
                    errorMessage.style.display = 'block';
                    successMessage.style.display = 'none';
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Subscribe';
                }
            });
        });

        // Your existing definitions and video error handling code remains here
    </script>
</body>
</html>
